<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</title>
	<style>
		* { margin: 0; padding: 0; box-sizing: border-box; }
		body {
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			min-height: 100vh;
			padding: 20px;
			direction: rtl;
		}
		.container {
			max-width: 1000px;
			margin: 20px auto;
			background: #fff;
			padding: 30px;
			border-radius: 8px;
			box-shadow: 0 6px 18px rgba(0,0,0,.08);
		}
		h1 { text-align: right; margin-bottom: 30px; font-size: 2em; color: #222; }
		
		/* Summary boxes at the top */
		.summary-row {
			display: grid;
			grid-template-columns: 1fr 1fr 1fr;
			gap: 20px;
			margin-bottom: 30px;
		}
		.summary-box {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			padding: 20px;
			border-radius: 8px;
			text-align: center;
			box-shadow: 0 4px 12px rgba(0,0,0,0.15);
		}
		.summary-box .label {
			font-size: 0.9em;
			font-weight: 600;
			opacity: 0.95;
			margin-bottom: 10px;
		}
		.summary-box .value {
			font-size: 2.2em;
			font-weight: 800;
		}
		
		/* Form layout: three columns on top row, button on bottom */
		.form-group {
			display: grid;
			grid-template-columns: 1fr 1fr 1fr;
			gap: 20px;
			margin-bottom: 20px;
			align-items: flex-start;
		}
		.form-group > div {
			display: flex;
			flex-direction: column;
		}
		.form-group label { 
			font-weight: 700;
			margin-bottom: 10px;
			color: #333;
			font-size: 1em;
			text-align: right;
		}
		.form-group input {
			padding: 12px;
			border: 2px solid #999;
			border-radius: 6px;
			font-size: 1em;
			font-family: inherit;
			text-align: right;
		}
		.form-group input:focus { 
			outline: none;
			border-color: #667eea;
			box-shadow: 0 0 4px rgba(102, 126, 234, 0.3);
		}
		
		/* Button in its own row */
		.button-row {
			display: flex;
			justify-content: flex-start;
			margin-bottom: 30px;
		}
		.form-group button,
		.button-row button {
			padding: 12px 28px;
			background: #667eea;
			color: white;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-weight: 700;
			font-size: 0.95em;
		}
		.form-group button:hover,
		.button-row button:hover { background: #5568d3; }
		
		.table-wrapper { overflow-x: auto; margin-top: 30px; }
		table {
			width: 100%;
			border-collapse: collapse;
		}
		thead { background: #667eea; color: white; }
		th {
			padding: 12px;
			text-align: right;
			font-weight: 600;
			font-size: 1em;
		}
		td {
			padding: 12px;
			border-bottom: 1px solid #ddd;
			text-align: right;
		}
		tbody tr:hover { background: #f5f5f5; }
		tbody tr:nth-child(even) { background: #fafafa; }
		.delete-btn {
			background: #e74c3c !important;
			padding: 6px 10px !important;
			font-size: 0.85em !important;
			cursor: pointer;
			border: none !important;
			color: white !important;
			border-radius: 4px !important;
		}
		.delete-btn:hover { background: #c0392b !important; }
		.empty-message { text-align: center; color: #999; padding: 30px; font-size: 1em; }
		.back-btn {
			background: #34495e;
			color: #fff;
			padding: 10px 18px;
			border: 0;
			border-radius: 6px;
			cursor: pointer;
			margin-top: 20px;
		}
		.back-btn:hover { opacity: 0.9; }
	</style>
</head>
<body>
	<div class="container">
		<h1>ğŸ“Š Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h1>

		<!-- Summary boxes -->
		<div class="summary-row">
			<div class="summary-box">
				<div class="label">Ø§Ù„Ø®Ø²Ù†Ø©</div>
				<div id="totalCash" class="value">0.00</div>
			</div>
			<div class="summary-box">
				<div class="label">Ø§Ù„Ø®Ø§Ø±Ø¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©</div>
				<div id="totalExpenses" class="value">0.00</div>
			</div>
			<div class="summary-box">
				<div class="label">Ø§Ù„ØªØ­ØµÙŠÙ„</div>
				<div id="totalCollection" class="value">0.00</div>
			</div>
		</div>

		<!-- Input Form -->
		<div class="form-group">
			<div>
				<label for="expense">Ø§Ù„Ø®Ø§Ø±Ø¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©</label>
				<input type="text" id="expense" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†">
			</div>
			<div>
				<label for="amount">Ø§Ù„Ù…Ø¨Ù„Øº</label>
				<input type="number" id="amount" placeholder="0" min="0">
			</div>
			<div>
				<label for="date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
				<input type="date" id="date">
			</div>
		</div>
		
		<!-- Add Button -->
		<div class="button-row">
			<button onclick="addEntry()">Ø¥Ø¶Ø§ÙØ©</button>
		</div>

		<!-- Data Table -->
		<div class="table-wrapper">
			<table id="accountsTable">
				<thead>
					<tr>
						<th>Ø§Ù„Ø®Ø§Ø±Ø¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©</th>
						<th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
						<th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
						<th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
					</tr>
				</thead>
				<tbody id="tableBody">
				</tbody>
			</table>
			<div id="emptyMessage" class="empty-message">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</div>
		</div>

		<button class="back-btn" onclick="window.location.href='index.html'">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
	</div>

	<script>
		function updateSummary() {
			const entries = loadEntries();
			const totalExpenses = entries.reduce((sum, e) => sum + (parseFloat(e.amount) || 0), 0);
			
			// Get Ø§Ù„ØªØ­ØµÙŠÙ„ (collection) total from index.html pharmacies data
			const pharamcyData = JSON.parse(localStorage.getItem('pharmacies') || '[]');
			const totalCollection = pharamcyData.reduce((sum, p) => sum + (parseFloat(p.collection) || 0), 0);
			
			// Calculate Ø§Ù„Ø®Ø²Ù†Ø© = Ø§Ù„ØªØ­ØµÙŠÙ„ - Ø§Ù„Ø®Ø§Ø±Ø¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©
			const totalCash = totalCollection - totalExpenses;
			
			document.getElementById('totalCash').textContent = totalCash.toFixed(2);
			document.getElementById('totalExpenses').textContent = totalExpenses.toFixed(2);
			document.getElementById('totalCollection').textContent = totalCollection.toFixed(2);
		}

		function loadEntries() {
			const saved = localStorage.getItem('accountsEntries');
			return saved ? JSON.parse(saved) : [];
		}

		function saveEntries(entries) {
			localStorage.setItem('accountsEntries', JSON.stringify(entries));
		}

		function addEntry() {
			const expense = document.getElementById('expense').value.trim();
			const amount = document.getElementById('amount').value.trim();
			const date = document.getElementById('date').value;

			if (!expense || !amount || !date) {
				alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
				return;
			}

			const entries = loadEntries();
			const newEntry = {
				id: Date.now(),
				expense: expense,
				amount: parseFloat(amount),
				date: date
			};

			entries.push(newEntry);
			saveEntries(entries);

			document.getElementById('expense').value = '';
			document.getElementById('amount').value = '';
			document.getElementById('date').value = '';

			updateSummary();
			renderTable();
		}

		function deleteEntry(id) {
			if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù†Ø¯ØŸ')) {
				const entries = loadEntries();
				const filtered = entries.filter(e => e.id !== id);
				saveEntries(filtered);
				updateSummary();
				renderTable();
			}
		}

		function renderTable() {
			const entries = loadEntries();
			const tableBody = document.getElementById('tableBody');
			const emptyMessage = document.getElementById('emptyMessage');

			tableBody.innerHTML = '';

			if (entries.length === 0) {
				emptyMessage.style.display = 'block';
				document.getElementById('accountsTable').style.display = 'none';
				return;
			}

			emptyMessage.style.display = 'none';
			document.getElementById('accountsTable').style.display = 'table';

			entries.forEach(entry => {
				const row = document.createElement('tr');
				row.innerHTML = `
					<td>${entry.expense}</td>
					<td>${entry.amount.toFixed(2)}</td>
					<td>${entry.date}</td>
					<td><button class="delete-btn" onclick="deleteEntry(${entry.id})">Ø­Ø°Ù</button></td>
				`;
				tableBody.appendChild(row);
			});
		}

		// Initial render
		updateSummary();
		renderTable();
	</script>
</body>
</html>
